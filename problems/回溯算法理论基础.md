
> 

# 什么是回溯法 
回溯法也可以叫做回溯搜索法，它是一种搜索的方式。 

在二叉树系列中，我们已经不止一次，提到了回溯，例如[二叉树：以为使用了递归，其实还隐藏着回溯](https://mp.weixin.qq.com/s/ivLkHzWdhjQQD1rQWe6zWA)。

回溯是递归的副产品，只要有递归就会有回溯。

回溯法的性能如何呢，这里要很大家说清楚了，**虽然回溯法很难，很不好理解，但是回溯法并不是什么高效的算法**。

# 回溯法的效率

**因为回溯的本质是穷举，穷举所有可能，然后选出我们想要的答案**，如果想让回溯法高效一些，可以加一些剪枝的操作，但也改不了回溯法就是穷举的本质。

那么既然回溯法并不高效为什么还要用它呢？ 

因为没得选，一些问题只能暴力搜，没有更优的算法了。

# 回溯法解决的问题 



回溯算法，相信

**回溯的问题都可以抽象为一个树形结构，在求解组合问题的过程中，n相当于树的宽度，k相当于树的深度**。

# 题外话 

一些同学可能分不清什么是组合，什么是排列？

组合是不强调元素顺序的，排列是强调元素顺序的。

例如：{1, 2} 和 {2, 1} 在组合上，就是一个集合，因为不强调顺序，而要是排列的话，{1, 2} 和 {2, 1} 就是两个集合了。

## 回溯算法模板 

这里将给出Carl总结的回溯算法模板，那么先来讲一讲回溯算法的模板伪代码。

既然回溯是递归的副产品，那么必然要有递归。

**所以以下讲解中，回溯函数也就是递归函数，指的都是一个函数**。

在讲[二叉树的递归](https://mp.weixin.qq.com/s/PwVIfxDlT3kRgMASWAMGhA)中我们说了递归三部曲，这里我再给大家列出回溯三部曲。

* 回溯函数模板返回值以及参数 

回溯函数伪代码如下：

```
backtracking(参数) 
```

在回溯算法中，我的习惯函数起名字为backtracking，回溯中递归返回值一般为void。 

在来看一下参数，因为回溯算法需要的参数，可不像二叉树递归的时候那么容易一次性确定下来，所以一般是先写逻辑，需要什么参数，就填什么参数。

但后面的回溯题目的讲解中，为了方便理解，我在一开始就帮大家把参数确定下来。

* 回溯函数终止条件 

回溯函数终止条件伪代码如下：
```
if (终止条件) {
    存放结果;
}
```

既然是树形结构，那么我们在讲解[二叉树的递归](https://mp.weixin.qq.com/s/PwVIfxDlT3kRgMASWAMGhA)的时候，就知道遍历树形结构一定要有终止条件。

所以回溯也有要终止条件。

什么时候达到了终止条件，树中就可以看出，搜到了叶子节点了，就找到了一个符合题目要求的答案，就把这个答案存放起来。


* 回溯搜索的遍历过程 

回溯函数遍历过程伪代码如下：
```
for (选择：选择列表（可以想成树中每个节点孩子的数量）) {
    递归，处理节点;
    backtracking(路径，选择列表);
    回溯，撤销处理结果
}
```

看一下这个for循环，这个for循环是做什么呢？

for 就是处理树中每一个节点的各个孩子的情况， 一个节点有多少个孩子，这个for循环就执行多少次。

注意这个backtracking就是自己调用自己，实现递归。

**一些同学对递归操作本来就不熟练，递归上面又加上一个for循环，可能就更迷糊了**， 我再给大家捋顺一下。

这个backtracking（递归函数）是从根节点向树的叶子节点方向遍历，**for循环可以理解是横向遍历，backtracking（递归）就是纵向遍历**，这样就把这棵树全遍历完了，如图所示：

<img src='../pics/77.组合1.png' width=600> </img></div>

backtracking一直往深处遍历，总会遇到叶子节点，遇到了叶子节点就要返回，那么backtracking的下面部分就是回溯的操作了，撤销本次处理的结果。

分析完过程，回溯算法模板框架如下：

```
backtracking(参数) {
    if (终止条件) {
        存放结果;
    }

    for (选择：选择列表（可以想成树中每个节点孩子的数量）) {
        递归，处理节点;
        backtracking(路径，选择列表);
        回溯，撤销处理结果
    }
}

```

